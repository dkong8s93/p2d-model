function output=jpNL(cp,sp,Phip,phip,Tp,Tref)
    tp=sp./51554;
    F=(4.656-88.699.*tp.^2+401.119.*tp.^4-342.909.*tp.^6+462.471.*tp.^8-433.434.*tp.^10)./(-1+18.993.*tp.^2-79.532.*tp.^4+...
        37.311.*tp.^6-73.083.*tp.^8+95.96.*tp.^10)+0.001.*(Tp-Tref).*(0.199521039-0.928373822.*tp+1.364550689000003.*tp.^2-...
        0.6115448939999998.*tp.^3)./(1-5.661479886999997.*tp+11.47636191.*tp.^2-9.82431213599998.*tp.^3+3.048755063.*tp.^4);
    output=(-4.668.*(10.^(-11)).*exp((-5000./8.314472).*(1./Tp-1./Tref))).*sqrt(cp.*(51554-sp).*sp).*sinh(0.5.*96485./(8.314472.*Tp).*(Phip-phip+F));
end
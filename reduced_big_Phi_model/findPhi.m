function [Phip,Phin]=findPhi(sp,sn,phip,phin,Tp,Tn,Tref)
    tp=sp./51554;
    F=(4.656-88.699.*tp.^2+401.119.*tp.^4-342.909.*tp.^6+462.471.*tp.^8-433.434.*tp.^10)./(-1+18.993.*tp.^2-79.532.*tp.^4+...
        37.311.*tp.^6-73.083.*tp.^8+95.96.*tp.^10)+0.001.*(Tp-Tref).*(0.199521039-0.928373822.*tp+1.364550689000003.*tp.^2-...
        0.6115448939999998.*tp.^3)./(1-5.661479886999997.*tp+11.47636191.*tp.^2-9.82431213599998.*tp.^3+3.048755063.*tp.^4);
    Phip=phip-F;
    
    tn=sn./30555;
    G=-(0.7222+0.1387.*tn+0.029.*sqrt(tn)-0.0172./tn+0.0019./tn.^(1.5)+0.2808.*exp(0.9-15.*tn)-0.7984.*exp(0.4465.*tn-0.4108))-(Tn-Tref).*...
        0.001.*(0.005268056+3.299265709.*tn-91.79325798.*tn.^2+1004.911008.*tn.^3-5812.278127.*tn.^4+19329.7549.*tn.^5-...
        37147.8947.*tn.^6+38379.18127.*tn.^7-16515.05308.*tn.^8)./(1-48.09287227.*tn+1017.234804.*tn.^2-10481.80419.*tn.^3+59431.3.*tn.^4-...
        195881.6488.*tn.^5+374577.3152.*tn.^6-385821.1607.*tn.^7+165705.8597.*tn.^8);
    Phin=phin-G;
end
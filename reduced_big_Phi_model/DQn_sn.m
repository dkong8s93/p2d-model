function output=DQn_sn(sn,jn,Tn,Tref,d37)
    output=d37.*jn.*((117.*exp(9./10 - sn./2037))./848750 + (445607.*exp((893.*sn)./61110000 - 1027./2500))./38193750000 - 29./(61110000.*(sn./30555).^(1./2)) + 19./(203700000.*(sn./30555).^(5./2)) - 262773./(500.*sn.^2) - (Tn.*((4539623223699461.*sn.^7)./26104065630945625482617953442717289676800000000000 - (659349313607623.*sn.^6)./61023600605338442346630089633955840000000000 + (1021113554251211.*sn.^5)./3728055019799217554586030676377600000000 - (110694220180261.*sn.^4)./30502822940592518037850030080000000 + (639066738450461.*sn.^3)./23959016546366239008620544000000 - (1104911338176101.*sn.^2)./10455033675390275026944000000 + (1291875257605787.*sn)./6569682427343913615360000 - 103184526511449./955607545932677120000))./((1138721997067303.*sn.^8)./5220813126189125096523590688543457935360000000 - (1104726178207507.*sn.^7)./71194200706228182737735104572948480000000 + (47668068699481.*sn.^6)./103557083883311598738500852121600000 - (6730442203860461.*sn.^5)./915084688217775541135500902400000 + (453787537526693.*sn.^4)./6655282373990621946839040000 - (5762432793488099.*sn.^3)./15682550513085412540416000 + (8947691961411523.*sn.^2)./8212103034179892019200 - (161154048835081.*sn)./102386522778501120 + 1) + ((Tn./1000 - Tref./1000).*((4539623223699461.*sn.^7)./26104065630945625482617953442717289676800000000 - (659349313607623.*sn.^6)./61023600605338442346630089633955840000000 + (1021113554251211.*sn.^5)./3728055019799217554586030676377600000 - (110694220180261.*sn.^4)./30502822940592518037850030080000 + (639066738450461.*sn.^3)./23959016546366239008620544000 - (1104911338176101.*sn.^2)./10455033675390275026944000 + (1291875257605787.*sn)./6569682427343913615360 - 103184526511449./955607545932677120))./((1138721997067303.*sn.^8)./5220813126189125096523590688543457935360000000 - (1104726178207507.*sn.^7)./71194200706228182737735104572948480000000 + (47668068699481.*sn.^6)./103557083883311598738500852121600000 - (6730442203860461.*sn.^5)./915084688217775541135500902400000 + (453787537526693.*sn.^4)./6655282373990621946839040000 - (5762432793488099.*sn.^3)./15682550513085412540416000 + (8947691961411523.*sn.^2)./8212103034179892019200 - (161154048835081.*sn)./102386522778501120 + 1) + ((Tn./1000 - Tref./1000).*((1138721997067303.*sn.^7)./652601640773640637065448836067932241920000000 - (1104726178207507.*sn.^6)./10170600100889740391105014938992640000000 + (47668068699481.*sn.^5)./17259513980551933123083475353600000 - (6730442203860461.*sn.^4)./183016937643555108227100180480000 + (453787537526693.*sn.^3)./1663820593497655486709760000 - (5762432793488099.*sn.^2)./5227516837695137513472000 + (8947691961411523.*sn)./4106051517089946009600 - 161154048835081./102386522778501120).*(- (4539623223699461.*sn.^8)./208832525047565003860943627541738317414400000000 + (659349313607623.*sn.^7)./427165204237369096426410627437690880000000 - (1021113554251211.*sn.^6)./22368330118795305327516184058265600000 + (110694220180261.*sn.^5)./152514114702962590189250150400000 - (639066738450461.*sn.^4)./95836066185464956034482176000 + (1104911338176101.*sn.^3)./31365101026170825080832000 - (1291875257605787.*sn.^2)./13139364854687827230720 + (103184526511449.*sn)./955607545932677120 + 759206881234141./144115188075855872))./((1138721997067303.*sn.^8)./5220813126189125096523590688543457935360000000 - (1104726178207507.*sn.^7)./71194200706228182737735104572948480000000 + (47668068699481.*sn.^6)./103557083883311598738500852121600000 - (6730442203860461.*sn.^5)./915084688217775541135500902400000 + (453787537526693.*sn.^4)./6655282373990621946839040000 - (5762432793488099.*sn.^3)./15682550513085412540416000 + (8947691961411523.*sn.^2)./8212103034179892019200 - (161154048835081.*sn)./102386522778501120 + 1).^2 - (Tn.*((1138721997067303.*sn.^7)./652601640773640637065448836067932241920000000 - (1104726178207507.*sn.^6)./10170600100889740391105014938992640000000 + (47668068699481.*sn.^5)./17259513980551933123083475353600000 - (6730442203860461.*sn.^4)./183016937643555108227100180480000 + (453787537526693.*sn.^3)./1663820593497655486709760000 - (5762432793488099.*sn.^2)./5227516837695137513472000 + (8947691961411523.*sn)./4106051517089946009600 - 161154048835081./102386522778501120).*(- (4539623223699461.*sn.^8)./208832525047565003860943627541738317414400000000000 + (659349313607623.*sn.^7)./427165204237369096426410627437690880000000000 - (1021113554251211.*sn.^6)./22368330118795305327516184058265600000000 + (110694220180261.*sn.^5)./152514114702962590189250150400000000 - (639066738450461.*sn.^4)./95836066185464956034482176000000 + (1104911338176101.*sn.^3)./31365101026170825080832000000 - (1291875257605787.*sn.^2)./13139364854687827230720000 + (103184526511449.*sn)./955607545932677120000 + 759206881234141./144115188075855872000))./((1138721997067303.*sn.^8)./5220813126189125096523590688543457935360000000 - (1104726178207507.*sn.^7)./71194200706228182737735104572948480000000 + (47668068699481.*sn.^6)./103557083883311598738500852121600000 - (6730442203860461.*sn.^5)./915084688217775541135500902400000 + (453787537526693.*sn.^4)./6655282373990621946839040000 - (5762432793488099.*sn.^3)./15682550513085412540416000 + (8947691961411523.*sn.^2)./8212103034179892019200 - (161154048835081.*sn)./102386522778501120 + 1).^2 - 1387./305550000);
end